let NotUpdatingIssues = [];
let HybridSiteData =[
  {
    "ID": 603152,
    "TL": "Godfred Ardeyfio"
  },
  {
    "ID": 612540,
    "TL": "Philip Adu Boakye"
  },
  {
    "ID": 612687,
    "TL": "Courage Mensah"
  },
  {
    "ID": 601044,
    "TL": "Courage Mensah"
  },
  {
    "ID": 602184,
    "TL": "Augustine Owusu"
  },
  {
    "ID": 602546,
    "TL": "Bright Kusi Appiah"
  },
  {
    "ID": 601103,
    "TL": "Courage Mensah"
  },
  {
    "ID": 602612,
    "TL": "Isaac Furgusson"
  },
  {
    "ID": 602854,
    "TL": "Courage Mensah"
  },
  {
    "ID": 612738,
    "TL": "Godfred Ardeyfio"
  },
  {
    "ID": 602454,
    "TL": "Isaac Furgusson"
  },
  {
    "ID": 613131,
    "TL": "Bright Kusi Appiah"
  },
  {
    "ID": 613149,
    "TL": "Emmanuel Acquah"
  },
  {
    "ID": 602493,
    "TL": "Bernard Siemoglo"
  },
  {
    "ID": 601768,
    "TL": "Courage Mensah"
  },
  {
    "ID": 601104,
    "TL": "Courage Mensah"
  },
  {
    "ID": 600585,
    "TL": "Richmond Kesseh"
  },
  {
    "ID": 601076,
    "TL": "Victor Mensah"
  },
  {
    "ID": 601750,
    "TL": "Bright Kusi Appiah"
  },
  {
    "ID": 601051,
    "TL": "Augustine Owusu"
  },
  {
    "ID": 602603,
    "TL": "Bernard Siemoglo"
  },
  {
    "ID": 603198,
    "TL": "Ben Twumasi Ankrah"
  },
  {
    "ID": 601082,
    "TL": "Benjamin Essuman"
  },
  {
    "ID": 601113,
    "TL": "Bernard Siemoglo"
  },
  {
    "ID": 613238,
    "TL": "John Ayama"
  },
  {
    "ID": 604918,
    "TL": "Benjamin Essuman"
  },
  {
    "ID": 613259,
    "TL": "Philip Adu Boakye"
  },
  {
    "ID": 602620,
    "TL": "Bernard Siemoglo"
  },
  {
    "ID": 604588,
    "TL": "Benjamin Essuman"
  },
  {
    "ID": 601395,
    "TL": "Emmanuel Ntoney"
  },
  {
    "ID": 602963,
    "TL": "Bright Kusi Appiah"
  },
  {
    "ID": 601053,
    "TL": "John Ayama"
  },
  {
    "ID": 601699,
    "TL": "Emmanuel Acquah"
  },
  {
    "ID": 602590,
    "TL": "Victor Mensah"
  },
  {
    "ID": 604987,
    "TL": "Victor Mensah"
  },
  {
    "ID": 613232,
    "TL": "Isaac Furgusson"
  },
  {
    "ID": 601081,
    "TL": "Benjamin Essuman"
  },
  {
    "ID": 602549,
    "TL": "Ayuba Dramani"
  },
  {
    "ID": 601403,
    "TL": "Victor Mensah"
  },
  {
    "ID": 601078,
    "TL": "Jacob Achaare"
  },
  {
    "ID": 602024,
    "TL": "Wilberforce Suglo"
  },
  {
    "ID": 602005,
    "TL": "Emmanuel Ntoney"
  },
  {
    "ID": 604767,
    "TL": "Ben Twumasi Ankrah"
  },
  {
    "ID": 602002,
    "TL": "Emmanuel Ntoney"
  },
  {
    "ID": 601452,
    "TL": "Augustine Owusu"
  },
  {
    "ID": 603152,
    "TL": "Godfred Ardeyfio"
  },
  {
    "ID": 601761,
    "TL": "Courage Mensah"
  },
  {
    "ID": 604896,
    "TL": "Augustine Owusu"
  },
  {
    "ID": 601756,
    "TL": "Benjamin Essuman"
  },
  {
    "ID": 601077,
    "TL": "Wilberforce Suglo"
  },
  {
    "ID": 601055,
    "TL": "Wilberforce Suglo"
  },
  {
    "ID": 600556,
    "TL": "Peter Boateng"
  },
  {
    "ID": 612509,
    "TL": "Jacob Achaare"
  },
  {
    "ID": 600772,
    "TL": "Godfred Ardeyfio"
  },
  {
    "ID": 600776,
    "TL": "Bernard Siemoglo"
  },
  {
    "ID": 612676,
    "TL": "Bernard Siemoglo"
  },
  {
    "ID": 601061,
    "TL": "Bright Kusi Appiah"
  },
  {
    "ID": 601095,
    "TL": "Ben Twumasi Ankrah"
  },
  {
    "ID": 601747,
    "TL": "Emmanuel Ntoney"
  },
  {
    "ID": 602858,
    "TL": "Victor Mensah"
  },
  {
    "ID": 602178,
    "TL": "Wilberforce Suglo"
  },
  {
    "ID": 602450,
    "TL": "Victor Mensah"
  },
  {
    "ID": 601092,
    "TL": "Isaac Furgusson"
  },
  {
    "ID": 601085,
    "TL": "Benjamin Essuman"
  },
  {
    "ID": 602611,
    "TL": "Bernard Siemoglo"
  },
  {
    "ID": 604998,
    "TL": "Jacob Achaare"
  },
  {
    "ID": 612681,
    "TL": "Philip Adu Boakye"
  },
  {
    "ID": 600580,
    "TL": "Jacob Achaare"
  },
  {
    "ID": 600479,
    "TL": "Ben Twumasi Ankrah"
  },
  {
    "ID": 601060,
    "TL": "Richmond Kesseh"
  },
  {
    "ID": 602599,
    "TL": "Peter Boateng"
  },
  {
    "ID": 601749,
    "TL": "Wilberforce Suglo"
  },
  {
    "ID": 602591,
    "TL": "Ben Twumasi Ankrah"
  },
  {
    "ID": 601108,
    "TL": "Richmond Kesseh"
  },
  {
    "ID": 601069,
    "TL": "Isaac Furgusson"
  },
  {
    "ID": 601723,
    "TL": "John Ayama"
  },
  {
    "ID": 604951,
    "TL": "Godfred Ardeyfio"
  },
  {
    "ID": 600496,
    "TL": "Wilberforce Suglo"
  },
  {
    "ID": 602233,
    "TL": "Bright Kusi Appiah"
  },
  {
    "ID": 602025,
    "TL": "Augustine Owusu"
  },
  {
    "ID": 604850,
    "TL": "Benjamin Essuman"
  },
  {
    "ID": 601724,
    "TL": "Bright Kusi Appiah"
  },
  {
    "ID": 613134,
    "TL": "Ben Twumasi Ankrah"
  },
  {
    "ID": 601106,
    "TL": "Courage Mensah"
  },
  {
    "ID": 601397,
    "TL": "Victor Mensah"
  },
  {
    "ID": 601834,
    "TL": "John Ayama"
  },
  {
    "ID": 613133,
    "TL": "Bernard Siemoglo"
  },
  {
    "ID": 604903,
    "TL": "Isaac Furgusson"
  },
  {
    "ID": 612688,
    "TL": "Richmond Kesseh"
  },
  {
    "ID": 603146,
    "TL": "Godfred Ardeyfio"
  },
  {
    "ID": 602542,
    "TL": "Benjamin Essuman"
  },
  {
    "ID": 600530,
    "TL": "Jacob Achaare"
  },
  {
    "ID": 602482,
    "TL": "Jacob Achaare"
  },
  {
    "ID": 613127,
    "TL": "Victor Mensah"
  },
  {
    "ID": 601809,
    "TL": "Ayuba Dramani"
  },
  {
    "ID": 604871,
    "TL": "Philip Adu Boakye"
  },
  {
    "ID": 601754,
    "TL": "John Ayama"
  },
  {
    "ID": 601700,
    "TL": "Philip Adu Boakye"
  },
  {
    "ID": 604657,
    "TL": "Victor Mensah"
  },
  {
    "ID": 602857,
    "TL": "John Ayama"
  },
  {
    "ID": 601401,
    "TL": "Jacob Achaare"
  },
  {
    "ID": 602458,
    "TL": "Courage Mensah"
  },
  {
    "ID": 602287,
    "TL": "Emmanuel Acquah"
  },
  {
    "ID": 612868,
    "TL": "Peter Boateng"
  },
  {
    "ID": 602589,
    "TL": "Bernard Siemoglo"
  },
  {
    "ID": 612793,
    "TL": "Ben Twumasi Ankrah"
  },
  {
    "ID": 601054,
    "TL": "John Ayama"
  },
  {
    "ID": 600528,
    "TL": "Jacob Achaare"
  },
  {
    "ID": 604594,
    "TL": "Augustine Owusu"
  },
  {
    "ID": 601482,
    "TL": "Bernard Siemoglo"
  },
  {
    "ID": 604471,
    "TL": "Emmanuel Acquah"
  },
  {
    "ID": 602333,
    "TL": "Emmanuel Ntoney"
  },
  {
    "ID": 604863,
    "TL": "Peter Boateng"
  },
  {
    "ID": 603151,
    "TL": "Isaac Furgusson"
  },
  {
    "ID": 604480,
    "TL": "Philip Adu Boakye"
  },
  {
    "ID": 600744,
    "TL": "Godfred Ardeyfio"
  },
  {
    "ID": 601760,
    "TL": "Courage Mensah"
  },
  {
    "ID": 601073,
    "TL": "Ben Twumasi Ankrah"
  },
  {
    "ID": 601765,
    "TL": "Ayuba Dramani"
  },
  {
    "ID": 602653,
    "TL": "Emmanuel Acquah"
  },
  {
    "ID": 604473,
    "TL": "Courage Mensah"
  },
  {
    "ID": 604478,
    "TL": "Bright Kusi Appiah"
  },
  {
    "ID": 604731,
    "TL": "Ayuba Dramani"
  },
  {
    "ID": 613237,
    "TL": "Emmanuel Ntoney"
  },
  {
    "ID": 602544,
    "TL": "Philip Adu Boakye"
  },
  {
    "ID": 602602,
    "TL": "Ben Twumasi Ankrah"
  },
  {
    "ID": 604447,
    "TL": "Richmond Kesseh"
  },
  {
    "ID": 604754,
    "TL": "Jacob Achaare"
  },
  {
    "ID": 612664,
    "TL": "Victor Mensah"
  },
  {
    "ID": 601729,
    "TL": "Augustine Owusu"
  },
  {
    "ID": 604537,
    "TL": "Augustine Owusu"
  },
  {
    "ID": 601084,
    "TL": "Benjamin Essuman"
  },
  {
    "ID": 601740,
    "TL": "Isaac Furgusson"
  },
  {
    "ID": 602666,
    "TL": "Courage Mensah"
  },
  {
    "ID": 601744,
    "TL": "Emmanuel Ntoney"
  },
  {
    "ID": 613153,
    "TL": "Courage Mensah"
  },
  {
    "ID": 602547,
    "TL": "Emmanuel Acquah"
  },
  {
    "ID": 601080,
    "TL": "Jacob Achaare"
  },
  {
    "ID": 613142,
    "TL": "John Ayama"
  },
  {
    "ID": 604756,
    "TL": "Philip Adu Boakye"
  },
  {
    "ID": 601097,
    "TL": "Ayuba Dramani"
  },
  {
    "ID": 602966,
    "TL": "Jacob Achaare"
  },
  {
    "ID": 612791,
    "TL": "Philip Adu Boakye"
  },
  {
    "ID": 602874,
    "TL": "Richmond Kesseh"
  },
  {
    "ID": 602696,
    "TL": "John Ayama"
  },
  {
    "ID": 612666,
    "TL": "Jacob Achaare"
  },
  {
    "ID": 601931,
    "TL": "Richmond Kesseh"
  },
  {
    "ID": 602592,
    "TL": "Bernard Siemoglo"
  },
  {
    "ID": 613128,
    "TL": "Victor Mensah"
  },
  {
    "ID": 601402,
    "TL": "Victor Mensah"
  },
  {
    "ID": 601757,
    "TL": "Courage Mensah"
  },
  {
    "ID": 601431,
    "TL": "Ayuba Dramani"
  },
  {
    "ID": 613233,
    "TL": "Ben Twumasi Ankrah"
  },
  {
    "ID": 602594,
    "TL": "Ben Twumasi Ankrah"
  },
  {
    "ID": 602859,
    "TL": "Augustine Owusu"
  },
  {
    "ID": 601057,
    "TL": "Bright Kusi Appiah"
  },
  {
    "ID": 604849,
    "TL": "Ben Twumasi Ankrah"
  },
  {
    "ID": 604858,
    "TL": "Philip Adu Boakye"
  },
  {
    "ID": 601841,
    "TL": "Ben Twumasi Ankrah"
  },
  {
    "ID": 613231,
    "TL": "Ben Twumasi Ankrah"
  },
  {
    "ID": 601062,
    "TL": "Wilberforce Suglo"
  },
  {
    "ID": 601427,
    "TL": "Bright Kusi Appiah"
  },
  {
    "ID": 604907,
    "TL": "Peter Boateng"
  },
  {
    "ID": 604483,
    "TL": "Wilberforce Suglo"
  },
  {
    "ID": 612682,
    "TL": "Peter Boateng"
  },
  {
    "ID": 602968,
    "TL": "Benjamin Essuman"
  },
  {
    "ID": 604583,
    "TL": "Wilberforce Suglo"
  },
  {
    "ID": 602022,
    "TL": "Bright Kusi Appiah"
  },
  {
    "ID": 600976,
    "TL": "Bernard Siemoglo"
  },
  {
    "ID": 601759,
    "TL": "Richmond Kesseh"
  },
  {
    "ID": 602595,
    "TL": "Godfred Ardeyfio"
  },
  {
    "ID": 601746,
    "TL": "Peter Boateng"
  },
  {
    "ID": 604888,
    "TL": "Bright Kusi Appiah"
  },
  {
    "ID": 601738,
    "TL": "Bright Kusi Appiah"
  },
  {
    "ID": 602483,
    "TL": "Benjamin Essuman"
  },
  {
    "ID": 601827,
    "TL": "Emmanuel Ntoney"
  },
  {
    "ID": 601074,
    "TL": "Ben Twumasi Ankrah"
  },
  {
    "ID": 612685,
    "TL": "Philip Adu Boakye"
  },
  {
    "ID": 600769,
    "TL": "Augustine Owusu"
  },
  {
    "ID": 602593,
    "TL": "Isaac Furgusson"
  },
  {
    "ID": 602183,
    "TL": "Bernard Siemoglo"
  },
  {
    "ID": 602453,
    "TL": "Emmanuel Acquah"
  },
  {
    "ID": 602851,
    "TL": "Bright Kusi Appiah"
  },
  {
    "ID": 601450,
    "TL": "Victor Mensah"
  },
  {
    "ID": 601072,
    "TL": "Victor Mensah"
  },
  {
    "ID": 613242,
    "TL": "Emmanuel Acquah"
  },
  {
    "ID": 604922,
    "TL": "Emmanuel Acquah"
  },
  {
    "ID": 600555,
    "TL": "John Ayama"
  },
  {
    "ID": 601075,
    "TL": "Benjamin Essuman"
  },
  {
    "ID": 604860,
    "TL": "Jacob Achaare"
  },
  {
    "ID": 602462,
    "TL": "Benjamin Essuman"
  },
  {
    "ID": 601755,
    "TL": "John Ayama"
  },
  {
    "ID": 603553,
    "TL": "Richmond Kesseh"
  },
  {
    "ID": 612683,
    "TL": "Peter Boateng"
  },
  {
    "ID": 603139,
    "TL": "Benjamin Essuman"
  },
  {
    "ID": 612679,
    "TL": "Wilberforce Suglo"
  },
  {
    "ID": 600616,
    "TL": "Ayuba Dramani"
  },
  {
    "ID": 604337,
    "TL": "John Ayama"
  },
  {
    "ID": 601726,
    "TL": "Peter Boateng"
  },
  {
    "ID": 601485,
    "TL": "Philip Adu Boakye"
  },
  {
    "ID": 600579,
    "TL": "Ben Twumasi Ankrah"
  },
  {
    "ID": 602965,
    "TL": "Emmanuel Ntoney"
  },
  {
    "ID": 601762,
    "TL": "Ayuba Dramani"
  },
  {
    "ID": 601064,
    "TL": "Wilberforce Suglo"
  },
  {
    "ID": 601758,
    "TL": "Richmond Kesseh"
  },
  {
    "ID": 604800,
    "TL": "Peter Boateng"
  },
  {
    "ID": 602967,
    "TL": "Emmanuel Ntoney"
  },
  {
    "ID": 604801,
    "TL": "Courage Mensah"
  },
  {
    "ID": 604859,
    "TL": "John Ayama"
  },
  {
    "ID": 604904,
    "TL": "Courage Mensah"
  },
  {
    "ID": 602494,
    "TL": "Augustine Owusu"
  },
  {
    "ID": 604917,
    "TL": "John Ayama"
  },
  {
    "ID": 604336,
    "TL": "Ben Twumasi Ankrah"
  },
  {
    "ID": 604864,
    "TL": "Philip Adu Boakye"
  },
  {
    "ID": 600770,
    "TL": "Victor Mensah"
  },
  {
    "ID": 601400,
    "TL": "Victor Mensah"
  },
  {
    "ID": 604766,
    "TL": "Victor Mensah"
  },
  {
    "ID": 604853,
    "TL": "John Ayama"
  },
  {
    "ID": 601836,
    "TL": "John Ayama"
  },
  {
    "ID": 602844,
    "TL": "Jacob Achaare"
  },
  {
    "ID": 601094,
    "TL": "Augustine Owusu"
  },
  {
    "ID": 604934,
    "TL": "Godfred Ardeyfio"
  },
  {
    "ID": 604273,
    "TL": "Bernard Siemoglo"
  },
  {
    "ID": 613145,
    "TL": "Philip Adu Boakye"
  },
  {
    "ID": 601093,
    "TL": "Wilberforce Suglo"
  },
  {
    "ID": 602652,
    "TL": "Godfred Ardeyfio"
  },
  {
    "ID": 601396,
    "TL": "Isaac Furgusson"
  },
  {
    "ID": 601457,
    "TL": "Emmanuel Acquah"
  },
  {
    "ID": 603368,
    "TL": "Victor Mensah"
  },
  {
    "ID": 604861,
    "TL": "Isaac Furgusson"
  },
  {
    "ID": 612680,
    "TL": "John Ayama"
  },
  {
    "ID": 602475,
    "TL": "Victor Mensah"
  },
  {
    "ID": 613143,
    "TL": "John Ayama"
  },
  {
    "ID": 612478,
    "TL": "Godfred Ardeyfio"
  },
  {
    "ID": 602026,
    "TL": "Benjamin Essuman"
  },
  {
    "ID": 601449,
    "TL": "Wilberforce Suglo"
  },
  {
    "ID": 613141,
    "TL": "Ben Twumasi Ankrah"
  },
  {
    "ID": 603156,
    "TL": "Wilberforce Suglo"
  },
  {
    "ID": 613230,
    "TL": "Isaac Furgusson"
  },
  {
    "ID": 602218,
    "TL": "Godfred Ardeyfio"
  },
  {
    "ID": 613252,
    "TL": "Emmanuel Acquah"
  },
  {
    "ID": 601483,
    "TL": "Ben Twumasi Ankrah"
  },
  {
    "ID": 601725,
    "TL": "Bright Kusi Appiah"
  },
  {
    "ID": 602699,
    "TL": "Isaac Furgusson"
  },
  {
    "ID": 601741,
    "TL": "Isaac Furgusson"
  },
  {
    "ID": 613140,
    "TL": "Ben Twumasi Ankrah"
  },
  {
    "ID": 601728,
    "TL": "Bernard Siemoglo"
  },
  {
    "ID": 600483,
    "TL": "Augustine Owusu"
  },
  {
    "ID": 601837,
    "TL": "John Ayama"
  },
  {
    "ID": 604707,
    "TL": "Philip Adu Boakye"
  },
  {
    "ID": 601736,
    "TL": "Isaac Furgusson"
  },
  {
    "ID": 601109,
    "TL": "Richmond Kesseh"
  },
  {
    "ID": 602545,
    "TL": "Wilberforce Suglo"
  },
  {
    "ID": 600482,
    "TL": "Isaac Furgusson"
  },
  {
    "ID": 613136,
    "TL": "Godfred Ardeyfio"
  },
  {
    "ID": 603199,
    "TL": "Bright Kusi Appiah"
  },
  {
    "ID": 604868,
    "TL": "Emmanuel Acquah"
  },
  {
    "ID": 612677,
    "TL": "Augustine Owusu"
  },
  {
    "ID": 602172,
    "TL": "Benjamin Essuman"
  },
  {
    "ID": 602548,
    "TL": "Ayuba Dramani"
  },
  {
    "ID": 613130,
    "TL": "Victor Mensah"
  },
  {
    "ID": 601458,
    "TL": "Godfred Ardeyfio"
  },
  {
    "ID": 604656,
    "TL": "Godfred Ardeyfio"
  },
  {
    "ID": 601071,
    "TL": "Ben Twumasi Ankrah"
  },
  {
    "ID": 604988,
    "TL": "Wilberforce Suglo"
  },
  {
    "ID": 613144,
    "TL": "Peter Boateng"
  },
  {
    "ID": 604947,
    "TL": "Isaac Furgusson"
  },
  {
    "ID": 604906,
    "TL": "Bernard Siemoglo"
  },
  {
    "ID": 601123,
    "TL": "Godfred Ardeyfio"
  },
  {
    "ID": 604641,
    "TL": "Ben Twumasi Ankrah"
  },
  {
    "ID": 613241,
    "TL": "Courage Mensah"
  },
  {
    "ID": 602577,
    "TL": "Emmanuel Acquah"
  },
  {
    "ID": 613150,
    "TL": "Richmond Kesseh"
  },
  {
    "ID": 604591,
    "TL": "Benjamin Essuman"
  },
  {
    "ID": 602449,
    "TL": "Philip Adu Boakye"
  },
  {
    "ID": 613243,
    "TL": "Courage Mensah"
  },
  {
    "ID": 602822,
    "TL": "Godfred Ardeyfio"
  },
  {
    "ID": 612686,
    "TL": "Peter Boateng"
  },
  {
    "ID": 601751,
    "TL": "Philip Adu Boakye"
  },
  {
    "ID": 604739,
    "TL": "Bernard Siemoglo"
  },
  {
    "ID": 601059,
    "TL": "Philip Adu Boakye"
  },
  {
    "ID": 604885,
    "TL": "Peter Boateng"
  },
  {
    "ID": 604590,
    "TL": "Benjamin Essuman"
  },
  {
    "ID": 604552,
    "TL": "Victor Mensah"
  },
  {
    "ID": 613132,
    "TL": "Ben Twumasi Ankrah"
  },
  {
    "ID": 601052,
    "TL": "Philip Adu Boakye"
  },
  {
    "ID": 602116,
    "TL": "Philip Adu Boakye"
  },
  {
    "ID": 602614,
    "TL": "Peter Boateng"
  },
  {
    "ID": 601737,
    "TL": "Ben Twumasi Ankrah"
  },
  {
    "ID": 612792,
    "TL": "Philip Adu Boakye"
  },
  {
    "ID": 604983,
    "TL": "Peter Boateng"
  },
  {
    "ID": 603209,
    "TL": "Ben Twumasi Ankrah"
  },
  {
    "ID": 604938,
    "TL": "Godfred Ardeyfio"
  },
  {
    "ID": 604334,
    "TL": "Ben Twumasi Ankrah"
  },
  {
    "ID": 602231,
    "TL": "Bright Kusi Appiah"
  },
  {
    "ID": 604593,
    "TL": "Augustine Owusu"
  },
  {
    "ID": 613152,
    "TL": "Emmanuel Acquah"
  },
  {
    "ID": 601454,
    "TL": "Bernard Siemoglo"
  },
  {
    "ID": 613249,
    "TL": "Bright Kusi Appiah"
  },
  {
    "ID": 604344,
    "TL": "Ben Twumasi Ankrah"
  },
  {
    "ID": 601769,
    "TL": "Richmond Kesseh"
  },
  {
    "ID": 604602,
    "TL": "Richmond Kesseh"
  },
  {
    "ID": 613137,
    "TL": "Ben Twumasi Ankrah"
  },
  {
    "ID": 600554,
    "TL": "Courage Mensah"
  },
  {
    "ID": 601727,
    "TL": "Emmanuel Ntoney"
  },
  {
    "ID": 602539,
    "TL": "Godfred Ardeyfio"
  },
  {
    "ID": 601453,
    "TL": "Augustine Owusu"
  },
  {
    "ID": 602173,
    "TL": "Jacob Achaare"
  },
  {
    "ID": 602564,
    "TL": "Emmanuel Acquah"
  },
  {
    "ID": 602117,
    "TL": "Isaac Furgusson"
  },
  {
    "ID": 602615,
    "TL": "Ben Twumasi Ankrah"
  },
  {
    "ID": 601404,
    "TL": "Victor Mensah"
  },
  {
    "ID": 601929,
    "TL": "Ben Twumasi Ankrah"
  },
  {
    "ID": 613251,
    "TL": "Peter Boateng"
  },
  {
    "ID": 613146,
    "TL": "Bright Kusi Appiah"
  },
  {
    "ID": 601398,
    "TL": "Godfred Ardeyfio"
  },
  {
    "ID": 601767,
    "TL": "Emmanuel Acquah"
  },
  {
    "ID": 604446,
    "TL": "Emmanuel Acquah"
  },
  {
    "ID": 601079,
    "TL": "Jacob Achaare"
  },
  {
    "ID": 602195,
    "TL": "Emmanuel Acquah"
  },
  {
    "ID": 612684,
    "TL": "John Ayama"
  },
  {
    "ID": 604642,
    "TL": "Ben Twumasi Ankrah"
  },
  {
    "ID": 613239,
    "TL": "Philip Adu Boakye"
  },
  {
    "ID": 604592,
    "TL": "Jacob Achaare"
  }
 ]

function tableToJSON() {
  return Array.from(document.querySelectorAll(".gridRowStyle"))
    .concat(Array.from(document.querySelectorAll(".gridAlternateRow")))
    .map((list) => {
      return {
        TimeStamp: list.children[0].innerText.trim(),
        SiteID: list.children[3].children[0].value.trim(),
        SiteName: list.children[4].children[0].value.trim(),
        SysVolt: list.children[11].innerText.trim(),
        DCVolt: list.children[16].innerText.trim(),
        RowRef: list,
      };
    });
}
function isHybrid(siteName) {
  return parseFloat(
    siteName
      .toLocaleLowerCase()
      .replaceAll(/[a-z]*[_]*/g, "")
      .substr(-4)
  ) > 15
    ? true
    : false;
}

function toShow({ SiteName, DCVolt, SysVolt }) {
  let show = false;
  let configuredThreshold = getThresholdFromName(SiteName);
  let currentDCVoltage = getCurrentDCVoltage(DCVolt);
  let currentSysVoltage = getCurrentSysVoltage(SysVolt);

  if (currentDCVoltage > 0 && currentDCVoltage <= configuredThreshold)
    show = true;
  if (currentSysVoltage > 0 && currentSysVoltage <= configuredThreshold)
    show = true;
  return show;
}

function issuesObject(issuesArray) {
  return issuesArray.map((tr) => {
    return {
      Date: tr.children[0].innerText.trim(),
      SiteID: tr.children[3].children[0].value.trim(),
      SiteName: tr.children[4].children[0].value.trim(),
      SysVolt: tr.children[11].innerText.trim(),
      DCVolt: tr.children[16].innerText.trim(),
    };
  });
}

function createOverlay() {
  let _overlay = document.createElement("div");
  _overlay.classList.add("info-overlay");
  _overlay.style.cssText = `position:fixed;
      top:2px;
      left:1112px;
      padding:9px;
      background-color:#1565c0 ; 
      width:auto;
      color:white;
      border-radius:10px;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      box-shadow: 1px 8px 5px 0px rgba(0,0,0,0.75);
      -webkit-box-shadow: 1px 8px 5px 0px rgba(0,0,0,0.75);
      -moz-box-shadow: 1px 8px 5px 0px rgba(0,0,0,0.75);
      display:flex;
      max-height:100%;
      overflow:hidden;
      z-index:1001;`;

  _overlay.innerHTML = `<p class="title">Hybrid Sites Not Updating | Count ${
  NotUpdatingIssues.length
  }| Last run: ${Date().toString().substr(4, 18)}</p>
      <div style='display:flex;align-items:center;justify-content:center;' class="body">
      <style>
      info-overlay.title{
         cursor: move;
         }
.info-overlay td{
  border:1px solid white;
  padding:0.3em;
}
.info-overlay thead td{
  background-color:#be4d25;
}
      </style>
      <table class="tg">
  <thead>
    <tr>
      <td class="tg-0lax">Last Updated @</td>
      <td class="tg-0lax">Site ID</td>
      <td class="tg-0lax">Site Name</td>
      <td class="tg-0lax">DC Voltage</td>
      <td class="tg-0lax">Sys Voltage</td>
      <td class="tg-0lax">Team Lead</td>
      <td class="tg-0lax"><a download='Hybrid_Sites_Not_Updating.csv' id='download'> Download</a></td>
    </tr>
  </thead>
  <tbody>
  </tbody>
  </table>  
      </div>`;
  document.body.appendChild(_overlay);
}

function highlightIssue(row) {
  row.children[16].style.cssText = `background-color:red;color:white;`;
  row.children[11].style.cssText = `background-color:red;color:white;`;
  row.children[4].children[0].style.cssText = `background-color:red;color:white;height:20px`;
}

function getThresholdFromName(SiteName) {
  let conf = parseFloat(
    SiteName.toLocaleLowerCase()
      .replaceAll(/[a-z]*[_]*/g, "")
      .substr(-4)
  );
  return conf;
}

function getCurrentDCVoltage(_dc) {
  return parseFloat(_dc);
}

function getCurrentSysVoltage(sys) {
  return parseFloat(sys);
}

function showNotUpdating() {
  console.log(NotUpdatingIssues)
  let timeDiff = null;
  document.querySelector(".info-overlay")
    ? document.querySelector(".info-overlay").remove()
    : "";
  tableToJSON().forEach(
    ({ SiteID, TimeStamp, SiteName, DCVolt, SysVolt, RowRef }) => {
      if (isHybrid(SiteName)) {
        timeDiff =
          (new Date().getTime() - new Date(TimeStamp).getTime()) /
          (1000 * 60 * 60);

        if (timeDiff > 1) {
          let TL = HybridSiteData.find((site) => site.ID == parseInt(SiteID));
          let name = TL.TL;
          TimeStamp.includes("09/23/2022") 
            ? NotUpdatingIssues.push({
                SiteID,
                TimeStamp,
                SiteName,
                DCVolt,
                SysVolt,
                name,
              })
            : "";
        }
      }
    }
  );
  /* console.log(NotUpdatingIssues)
  return false; */
  if (NotUpdatingIssues.length > 0) {
    let sortedIssues= NotUpdatingIssues.sort((a,b) =>{
      return (a.name.toLowerCase() > b.name.toLowerCase())?1:-1
    })
    displayIssuesOverlay(sortedIssues);
    attachDownload();
     NotUpdatingIssues = [];
    
  }
}

function displayIssuesOverlay(issues) {

  createOverlay();
  let tbodyRef = document.querySelector(".body tbody");
  dragElement(document.querySelector(".info-overlay"));
  let tpl = ``;
  if(issues < 30){
    issues.forEach(({ TimeStamp, SiteID, SiteName, DCVolt, SysVolt, name }) => {
      tpl =
        tpl +
        `<tr>
      <td>${TimeStamp}</td>
      <td>${SiteID}</td>
      <td>${SiteName}</td>
      <td>${DCVolt}</td>
      <td>${SysVolt}</td>
       <td>${name}</td>
    </tr>`;
    });
  
  }
  issues.slice(0,31).forEach(({ TimeStamp, SiteID, SiteName, DCVolt, SysVolt, name }) => {
    tpl =
      tpl +
      `<tr>
    <td>${TimeStamp}</td>
    <td>${SiteID}</td>
    <td>${SiteName}</td>
    <td>${DCVolt}</td>
    <td>${SysVolt}</td>
     <td>${name}</td>
  </tr>`;
  });
  tbodyRef.innerHTML = tpl;
  
}

//Drag implementation

function dragElement(elmnt) {
  var pos1 = 0,
    pos2 = 0,
    pos3 = 0,
    pos4 = 0;
  if (document.getElementById(elmnt.id + "header")) {
    document.getElementById(elmnt.id + "header").onmousedown = dragMouseDown;
  } else {
    elmnt.onmousedown = dragMouseDown;
  }

  function dragMouseDown(e) {
    e = e || window.event;
    e.preventDefault();
    // get the mouse cursor position at startup:
    pos3 = e.clientX;
    pos4 = e.clientY;
    document.onmouseup = closeDragElement;
    // call a function whenever the cursor moves:
    document.onmousemove = elementDrag;
  }

  function elementDrag(e) {
    e = e || window.event;
    e.preventDefault();
    // calculate the new cursor position:
    pos1 = pos3 - e.clientX;
    pos2 = pos4 - e.clientY;
    pos3 = e.clientX;
    pos4 = e.clientY;
    // set the element's new position:
    elmnt.style.top = elmnt.offsetTop - pos2 + "px";
    elmnt.style.left = elmnt.offsetLeft - pos1 + "px";
  }

  function closeDragElement() {
    /* stop moving when mouse button is released:*/
    document.onmouseup = null;
    document.onmousemove = null;
  }
}

function attachDownload() {
 
  let formatedCSV = NotUpdatingIssues.map( ({ SiteID,
    TimeStamp,
    SiteName,
    DCVolt,
    SysVolt,
    name,}) =>{
return {
  'Last Updated Time':TimeStamp,
  'Site ID':SiteID,
  'Site Name':SiteName,
  'DC Voltage':DCVolt,
  'System Voltage':SysVolt,
  'Team Lead':name
}
  })
  const keys = Object.keys(formatedCSV[0]);
  const CSV = [
    keys.join(","),
    formatedCSV.map((row) => keys.map((key) => row[key]).join(",")).join("\n"),
  ].join("\n");
  const csvBlob = new Blob([CSV]);
  const link = document.getElementById("download");
  link.href = URL.createObjectURL(csvBlob);
}

function start() {
  showNotUpdating();
  setTimeout(start, 90000);
}
start();
